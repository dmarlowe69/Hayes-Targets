
Title: 1805 CPU / A/D-D/A TEST
American Automation Cross-Assembler 1805 9.05.11
Assembly date: 13 Nov 1990
Assembly time:  9:47:01
Options in effect:expand format list object symbol errorfile uppercase 

Subtitle: (C)1984,85,86,87,88 HAYES INTERNATIONAL CORPORATION
0004 T B000                  T          SECTION TLXTEST,$B000
0005                           ;******************************************************************************
0006                           ;
0007                           ;       TLX-1 TEST SOFTWARE
0008                           ;
0009                           ;       MODIFIED NOV 13,1990 TO FIX ERROR IN EVENT FLAG TEST
0010                           ;
0011                           ;       (C) 1988 HAYES INTERNATIONAL CORP.
0012                           ;
0013                           ;       BY DENTON MARLOWE
0014                           ;
0015                           ;******************************************************************************
0016        0000B000           ORGIN    EQU     $B000               ; START ADDRESS OF THIS CODE
0017        00004000           RAM      EQU     $4000               ; BASE ADDRESS OF CPU RAM
0018        00003000           STACK    EQU     $3000               ; TEST ROUTINE RAM
0019        00002000           USER     EQU     $2000               ; USER STACK SPACE
0020        00008C00           TAPERAM  EQU     $8C00               ; BASE ADDRESS OF RAM ON TAPE I/O BOARD
0021        00008FFF           TAPETOP  EQU     $8FFF               ; TOP OF TAPE I/O BOARD RAM
0022        0000C800           MASTER   EQU     $C800               ; BASE ADDRESS OF MASTER TLX EPROM
0023        0000D000           DEBUG    EQU     $D000               ; BASE ADDRESS OF TERMINAL I/O ROUTINES
0024        0000D000           EPROM    EQU     $D000               ; BASE ADDRESS OF EPROM PROGRAMMING CODE
0025                           ;******************************************************************************
0026        0000D800           OSTRN1   EQU     DEBUG+$0800
0027        0000E804           OSTRNG   EQU     DEBUG+$1804
0028                           ;**************************
0029        0000D810           TYPEH1   EQU     DEBUG+$0810
0030        0000D814           TYPEHD   EQU     DEBUG+$0814
0031        0000D816           TYPEH    EQU     DEBUG+$0816
0032        0000D827           TYPED1   EQU     DEBUG+$0827
0033        0000D82B           TYPED    EQU     DEBUG+$082B
0034        0000D82D           TYPER    EQU     DEBUG+$082D
0035                           ;**************************
0036        0000D874           RCA1     EQU     DEBUG+$0874
0037        0000D889           DELAY1   EQU     DEBUG+$0889
0038                           ;**************************
0039        0000D898           READHX   EQU     DEBUG+$0898
0040        0000D8B8           READH1   EQU     DEBUG+$08B8
0041        0000D8BC           READHD   EQU     DEBUG+$08BC
0042        0000D8BE           READH    EQU     DEBUG+$08BE
0043        0000D900           READ1    EQU     DEBUG+$0900
0044        0000D904           READD    EQU     DEBUG+$0904
0045        0000D906           READ     EQU     DEBUG+$0906
0046                           ;**************************
0047        0000D933           TYPE31   EQU     DEBUG+$0933
0048        0000D937           TYPE3D   EQU     DEBUG+$0937
0049        0000D939           TYPE3    EQU     DEBUG+$0939
0050        0000D94A           TYPE61   EQU     DEBUG+$094A
0051        0000D94E           TYPE6D   EQU     DEBUG+$094E
0052        0000D950           TYPE6    EQU     DEBUG+$0950
0053        0000D95F           TYPE81   EQU     DEBUG+$095F
0054        0000D963           TYPE8D   EQU     DEBUG+$0963
0055        0000D965           TYPE8    EQU     DEBUG+$0965
0056                           ;**************************
0057        0000D96E           WORD31   EQU     DEBUG+$096E
0058        0000D972           WORD3D   EQU     DEBUG+$0972
0059        0000D974           WORD3    EQU     DEBUG+$0974
0060        0000D994           WORD61   EQU     DEBUG+$0994
0061        0000D998           WORD6D   EQU     DEBUG+$0998
0062        0000D99A           WORD6    EQU     DEBUG+$099A
0063        0000D9AC           WORD81   EQU     DEBUG+$09AC
0064        0000D9B0           WORD8D   EQU     DEBUG+$09B0
0065        0000D9B2           WORD     EQU     DEBUG+$09B2
0066                           ;**************************
0067        0000D9C8           TOUT31   EQU     DEBUG+$09C8
0068        0000D9CC           TOUT3D   EQU     DEBUG+$09CC
0069        0000D9CE           TOUT3    EQU     DEBUG+$09CE
0070        0000D9EE           MOUT31   EQU     DEBUG+$09EE
0071        0000D9F2           MOUT3D   EQU     DEBUG+$09F2
0072        0000D9F4           MOUT3    EQU     DEBUG+$09F4
0073        0000DA4B           TOUT61   EQU     DEBUG+$0A4B
0074        0000DA4F           TOUT6D   EQU     DEBUG+$0A4F
0075        0000DA51           TOUT6    EQU     DEBUG+$0A51
0076        0000DA76           MOUT1    EQU     DEBUG+$0A76
0077        0000DA7A           MOUTD    EQU     DEBUG+$0A7A
0078        0000DA7C           MOUT     EQU     DEBUG+$0A7C
0079        0000DAB5           T8OUT1   EQU     DEBUG+$0AB5
0080        0000DAB9           T8OUTD   EQU     DEBUG+$0AB9
0081        0000DABB           T8OUT    EQU     DEBUG+$0ABB
0082        0000DAD7           M8OUT1   EQU     DEBUG+$0AD7
0083        0000DADB           M8OUTD   EQU     DEBUG+$0ADB
0084        0000DADD           M8OUT    EQU     DEBUG+$0ADD
0085                           ;**************************
0086        0000DB6F           CLEAR    EQU     DEBUG+$0B6F
0087        0000DB1B           CRLF     EQU     DEBUG+$0B1B
0088        0000DB40           MLFCR    EQU     DEBUG+$0B40
0089        0000DB8E           RVON     EQU     DEBUG+$0B8E
0090        0000DB99           RVOFF    EQU     DEBUG+$0B99
0091        0000DC18           CURON    EQU     DEBUG+$0C18
0092        0000DC23           CUROFF   EQU     DEBUG+$0C23
0093        0000DD0C           ITEST    EQU     DEBUG+$0D0C
0094                           ;******************************************************************************
0095 T B000                             ORG     ORGIN
0096                           ;******************************************************************************
0097 T B000 71                          DIS                         ; DISABLE INTERRUPTS
0098 T B001 00                          DB      $00                     ; SET SP AND PC = R0
0099 T B002 68C24FFF                    RLDI    R2,RAM+$0FFF            ; SETUP FOR NEW SP
0100 T B006 E2                          SEX     R2                      ; NEW SP IS R2
0101 T B007 68C3B00C                    RLDI    R3,MENU                 ; SETUP FOR NEW PC
0102 T B00B D3                          SEP     R3                      ; NEW PC IS R3
0103                           ;******************************************************************************
0104                           ;
0105                           ;       MAIN TEST AND FUNCTION MENU
0106                           ;
0107                           ;******************************************************************************
0108 T B00C 6886DB6F           MENU:    SCAL    R6,CLEAR                ; CLEAR SCREEN
0109 T B010 6886DB6F                    SCAL    R6,CLEAR                ; CLEAR SCREEN
0110 T B014 6886DB99                    SCAL    R6,RVOFF                ; NORMAL VIEDO
0111 T B018 6886DC18                    SCAL    R6,CURON                ; TURN CURSOR ON
0112                           ;******************************************************************************
0113 T B01C 6886D800                    SCAL    R6,OSTRN1               ; PRINT MESSAGE
0114 T B020 0A0D                        DB      $0A,$0D                 ;
0115 T B022 544C5820434F4D50            DB      'TLX COMPONENT BENCH TEST SOFTWARE'
            4F4E454E54204245
            4E43482054455354
            20534F4654574152
            45
0116 T B043 0A0D                        DB      $0A,$0D
0117 T B045 56455253494F4E20            DB      'VERSION 1.0/26AUG88'
            312E302F32364155
            473838
0118 T B058 0A0D                        DB      $0A,$0D
0119 T B05A 5752495454454E20            DB      'WRITTEN BY DENTON MARLOWE'
            42592044454E544F
            4E204D41524C4F57
            45
0120 T B073 0A0D                        DB      $0A,$0D
0121 T B075 434F505952494748            DB      'COPYRIGHT 1988 HAYES TARGETS'
            5420313938382048
            4159455320544152
            47455453
0122 T B091 0A0A0A0D                    DB      $0A,$0A,$0A,$0D
0123 T B095 544C582044455645            DB      'TLX DEVELOPMENT SYSTEM MAIN TEST MENU',$0A,$0D
            4C4F504D454E5420
            53595354454D204D
            41494E2054455354
            204D454E550A0D
0124 T B0BC 0A0D                        DB      $0A,$0D 
0125 T B0BE 283129204D423630            DB      '(1) MB606 1805 CPU TEST',$0A,$0D
            3620313830352043
            505520544553540A
            0D
0126 T B0D7 283229204D423635            DB      '(2) MB654A A/D-D/A TEST',$0A,$0D
            344120412F442D44
            2F4120544553540A
            0D
0127 T B0F0 283329204550524F            DB      '(3) EPROM PROGRAMING FUNCTIONS',$0A,$0D
            4D2050524F475241
            4D494E472046554E
            4354494F4E530A0D
0128 T B110 2834292052544531            DB      '(4) RTE1/RDT1 FUNCTION TEST',$0A,$0D
            2F52445431204655
            4E4354494F4E2054
            4553540A0D
0129 T B12D 2835292044454255            DB      '(5) DEBUGGER TEST',$0A,$0D
            4747455220544553
            540A0D
0130 T B140 0A0D                        DB      $0A,$0D
0131 T B142 454E544552205445            DB      'ENTER TEST NUMBER '
            5354204E554D4245
            5220
0132 T B154 00                          DB      $00
0133                           
0134 T B155 6886D904                    SCAL    R6,READD                ; KEYBOARD INPUT
0135                           
0136 T B159 9F                          GHI     RF                      ; GET KEYPRESS
0137 T B15A FF31                        SMI     '1'                     ; ONE
0138 T B15C C2B800                      LBZ     CPUTST                  ; CPU TEST
0139                           
0140 T B15F 9F                          GHI     RF                      ; GET KEYPRESS
0141 T B160 FF32                        SMI     '2'                     ; TWO
0142 T B162 C2B17A                      LBZ     AMENU                   ; A/D-D/A TEST
0143                           
0144 T B165 9F                          GHI     RF                      ; GET KEYPRESS
0145 T B166 FF33                        SMI     '3'                     ; THREE
0146 T B168 C2BF00                      LBZ     IEPROM                  ; EPROM FUNCTIONS
0147                           
0148 T B16B 9F                          GHI     RF                      ; GET KEYPRESS
0149 T B16C FF34                        SMI     '4'                     ; FOUR
0150 T B16E C2C000                      LBZ     RTERTD                  ; ENCODER/DECODER TEST
0151                           
0152 T B171 9F                          GHI     RF                      ; GET KEYPRESS
0153 T B172 FF35                        SMI     '5'                     ; FIVE
0154 T B174 C2DD0C                      LBZ     ITEST                   ; DEBUGGER TEST
0155                           
0156 T B177 C0B00C                      LBR     MENU                   ; TRY AGAIN
0157                           ;******************************************************************************
0158                           ;
0159                           ;       MB654A A/D-D/A TEST MENU
0160                           ;
0161                           ;******************************************************************************
0162 T B17A 6886DB6F           AMENU:   SCAL    R6,CLEAR                ; CLEAR SCREEN
0163 T B17E 6886D800                    SCAL    R6,OSTRN1               ; PRINT MESSAGE
0164 T B182 0A0D                        DB      $0A,$0D                 ;
0165 T B184 4D42363534412041            DB      'MB654A A/D-D/A CONVERTER TEST MENU',$0A,$0D
            2F442D442F412043
            4F4E564552544552
            2054455354204D45
            4E550A0D
0166 T B1A8 0A0D                        DB      $0A,$0D 
0167 T B1AA 28312920412F442D            DB      '(1) A/D-D/A TEST',$0A,$0D
            442F412054455354
            0A0D
0168 T B1BC 28322920412F4420            DB      '(2) A/D CALIBRATION',$0A,$0D
            43414C4942524154
            494F4E0A0D
0169 T B1D1 28332920442F4120            DB      '(3) D/A CALIBRATION',$0A,$0D
            43414C4942524154
            494F4E0A0D
0170 T B1E6 2834292045584954            DB      '(4) EXIT TO MAIN MENU',$0A,$0D
            20544F204D41494E
            204D454E550A0D
0171 T B1FD 0A0D                        DB      $0A,$0D
0172 T B1FF 454E544552205445            DB      'ENTER TEST NUMBER '
            5354204E554D4245
            5220
0173 T B211 00                          DB      $00
0174                           
0175 T B212 6886D904                    SCAL    R6,READD                ; KEYBOARD INPUT
0176                           
0177 T B216 9F                          GHI     RF                      ; GET KEYPRESS
0178 T B217 FF31                        SMI     '1'                     ; ONE
0179 T B219 C2B300                      LBZ     ADTST                   ; A/D TEST
0180                           
0181 T B21C 9F                          GHI     RF                      ; GET KEYPRESS
0182 T B21D FF32                        SMI     '2'                     ; THREE
0183 T B21F C2B500                      LBZ     ADCAL                   ; A/D CALIBRATION
0184                           
0185 T B222 9F                          GHI     RF                      ; GET KEYPRESS
0186 T B223 FF33                        SMI     '3'                     ; FOUR
0187 T B225 C2B600                      LBZ     DACAL                   ; D/A CALIBRATION
0188                           
0189 T B228 9F                          GHI     RF                      ; GET KEYPRESS
0190 T B229 FF34                        SMI     '4'                     ; FIVE
0191 T B22B C2B00C                      LBZ     MENU                    ; RETURN TO MAIN MENU
0192                           
0193 T B22E C0B17A                      LBR     AMENU                   ; TRY AGAIN
0194                           ;******************************************************************************
0195                           
0196 T B300                             CORG    $0100               ; SET NEXT PAGE
0197                           
0198                           ;******************************************************************************
0199                           ;
0200                           ;       A/D-D/A TEST ROUTINE
0201                           ;
0202                           ;******************************************************************************
0203 T B300 C4                 ADTST:   NOP                         ; NO OPERATION
0204 T B301 6886DB6F                    SCAL    R6,CLEAR                ; CLEAR SCREEN
0205 T B305 6886D800                    SCAL    R6,OSTRN1               ; PRINT MESSAGE
0206 T B309 0A0D                        DB      $0A,$0D
0207 T B30B 4D42363534412041            DB      'MB654A A/D-D/A TEST'
            2F442D442F412054
            455354
0208 T B31E 0A0A0D00                    DB      $0A,$0A,$0D,$00
0209                           ;******************************************************************************
0210                           ;
0211                           ;       INITIALIZE OUTPUT DATA TO ZERO
0212                           ;
0213                           ;******************************************************************************
0214 T B322 68C10000                    RLDI    R1,$0000                ; ZERO DATA
0215                           ;******************************************************************************
0216                           ;
0217                           ;       SETUP D/A I/O MODE
0218                           ;
0219                           ;******************************************************************************
0220 T B326 68C24800           DATST1:  RLDI    R2,RAM+$0800            ; SETUP INPUT STACK
0221 T B32A E3                          SEX     R3                      ; SET PROGRAM COUNTER EQUAL SP
0222 T B32B 61                          OUT     1                       ; SET I/O GROUP
0223 T B32C 30                          DB      $30                     ; I/O GROUP 30
0224 T B32D E2                          SEX     R2                      ; RESET SP TO R2
0225                           ;******************************************************************************
0226                           ;
0227                           ;       OUTPUT DATA TO D/A CHANNELS 1 AND TWO
0228                           ;
0229                           ;******************************************************************************
0230 T B32E 81                          GLO     R1                      ; GET DATA
0231 T B32F 52                          STR     R2                      ; STACK IT
0232 T B330 63                          OUT     3                       ; OUTPUT DATA TO CHANNEL 1
0233 T B331 22                          DEC     R2                      ; RESET STACK POINTER
0234 T B332 64                          OUT     4                       ; OUTPUT DATA TO CHANNEL 2
0235 T B333 22                          DEC     R2                      ; RESET STACK POINTER
0236                           ;******************************************************************************
0237                           ;
0238                           ;       DISPLAY D/A OUTPUT DATA
0239                           ;
0240                           ;******************************************************************************
0241 T B334 68C24FFF                    RLDI    R2,RAM+$0FFF            ; RESET STACK POINTER FOR DEBUG ROUTINES
0242 T B338 68C70001                    RLDI    R7,$0001                ; SET INITIAL CHANNEL NUMBER
0243 T B33C 68CB0002                    RLDI    RB,$0002                ; TWO CHANNELS
0244                           
0245 T B340 6886D800                    SCAL    R6,OSTRN1               ; PRINT MESSAGE
0246 T B344 442F41204F555450            DB      'D/A OUTPUT'
            5554
0247 T B34E 0A0A0D                      DB      $0A,$0A,$0D
0248 T B351 00                          DB      $00
0249                           
0250 T B352 6886D800           01$:     SCAL    R6,OSTRN1               ; PRINT MESSAGE
0251 T B356 43482000                    DB      'CH ',$00               ; CHANNEL
0252 T B35A 87                          GLO     R7                      ; GET CHANNEL NUMBER
0253 T B35B BF                          PHI     RF                      ; LOAD REGISTER
0254 T B35C 6886D816                    SCAL    R6,TYPEH                ; PRINT CHANNEL NUMBER
0255 T B360 6886D800                    SCAL    R6,OSTRN1               ; PRINT MESSAGE
0256 T B364 202000                      DB      '  ',$00                ; SPACE OVER
0257 T B367 81                          GLO     R1                      ; LOAD DATA
0258 T B368 BD                          PHI     RD                      ; LOAD REGISTER
0259 T B369 6886D9B2                    SCAL    R6,WORD                 ; DISPLAY AS BITS
0260 T B36D 00                          DB      $00                     ; TERMINATION
0261 T B36E 6886D800                    SCAL    R6,OSTRN1               ; PRINT MESSAGE
0262 T B372 202000                      DB      '  ',$00                ; SPACE OVER
0263 T B375 81                          GLO     R1                      ; LOAD DATA
0264 T B376 BF                          PHI     RF                      ; LOAD REGISTER
0265 T B377 6886D816                    SCAL    R6,TYPEH                ; DISPLAY AS HEX
0266                           
0267 T B37B 6886D800                    SCAL    R6,OSTRN1               ; PRINT MESSAGE
0268 T B37F 0A0D00                      DB      $0A,$0D,$00             ; NEW LINE
0269                           
0270 T B382 17                          INC     R7                      ; INCREMENT CHANNEL NUMBER
0271 T B383 682BB352                    DBNZ    RB,01$                  ; LOOP FOR 2 CHANNELS
0272                           
0273 T B387 6886D800                    SCAL    R6,OSTRN1               ; PRINT MESSAGE
0274 T B38B 0A0A0D00                    DB      $0A,$0A,$0D,$00         ;
0275                           ;******************************************************************************
0276                           ;
0277                           ;       DELAY 3 SECONDS TO GIVE D/A OUTPUTS TIME TO SETTLE
0278                           ;
0279                           ;******************************************************************************
0280 T B38F 68CE0002                    RLDI    RE,$02                  ; LOAD OUTER COUNTER
0281 T B393 68CFFFFF           02$:     RLDI    RF,$FFFF                ; LOAD INNER COUNTER
0282 T B397 C4                 03$:     NOP                         ; NO OPERATION
0283 T B398 682FB397                    DBNZ    RF,03$                  ; DECREMENT INNER COUNTER
0284 T B39C 682EB393                    DBNZ    RE,02$                  ; DECREMENT OUTER COUNTER
0285                           ;******************************************************************************
0286                           ;
0287                           ;       SETUP A/D FOR SCAN MODE
0288                           ;
0289                           ;******************************************************************************
0290 T B3A0 E3                          SEX     R3                      ; SET PROGRAM COUNTER EQUAL SP
0291 T B3A1 61                          OUT     1                       ; SET I/O GROUP
0292 T B3A2 30                          DB      $30                     ; I/O GROUP 30
0293 T B3A3 66                          OUT     6                       ; SET CONVERSION MODE
0294 T B3A4 01                          DB      $01                     ; SCAN MODE LSB=1
0295 T B3A5 65                          OUT     5                       ; SELECT FIRST CHANNEL
0296 T B3A6 00                          DB      $00                     ; START AT CHANNEL ZERO
0297 T B3A7 E2                          SEX     R2                      ; RESET SP TO R2
0298                           ;******************************************************************************
0299                           ;
0300                           ;       SETUP INPUT STACK AND CHANNEL COUNTER
0301                           ;
0302                           ;******************************************************************************
0303 T B3A8 68C24800                    RLDI    R2,RAM+$0800            ; SETUP INPUT STACK
0304 T B3AC 68C40008                    RLDI    R4,$0008                ; EIGHT CYCLES
0305                           ;******************************************************************************
0306                           ;
0307                           ;       INPUT AND STACK DATA FROM A/D CONVERTER
0308                           ;
0309                           ;******************************************************************************
0310 T B3B0 3CB0               ADTST2:  BN1     *                       ; WAIT FOR CONVERSION
0311 T B3B2 6C                          INP     4                       ; INPUT AND START NEXT CONVERSION
0312 T B3B3 22                          DEC     R2                      ; DECREMENT SP FOR NEXT INPUT
0313 T B3B4 6824B3B0                    DBNZ    R4,ADTST2               ; LOOP FOR 8 CHANNELS
0314                           ;******************************************************************************
0315                           ;
0316                           ;       PRINT OUT A/D INPUT STACK
0317                           ;
0318                           ;******************************************************************************
0319 T B3B8 68C24FFF                    RLDI    R2,RAM+$0FFF        ; RESET STACK POINTER FOR DEBUG ROUTINES
0320 T B3BC 68CA4800                    RLDI    RA,RAM+$0800        ; LOAD STACK OF DATA STACK
0321 T B3C0 68CB0008                    RLDI    RB,$0008            ; LOAD COUNTER FOR NUMBER OF BYTES
0322 T B3C4 68C70001                    RLDI    R7,$0001            ; SET INITIAL CHANNEL NUMBER
0323                           
0324 T B3C8 6886D800                    SCAL    R6,OSTRN1           ; PRINT MESSAGE
0325 T B3CC 412F4420494E5055            DB      'A/D INPUT'
            54
0326 T B3D5 0A0A0D                      DB      $0A,$0A,$0D
0327 T B3D8 00                          DB      $00
0328                           
0329 T B3D9 6886D800           OUTIT:   SCAL    R6,OSTRN1           ; PRINT MESSAGE
0330 T B3DD 43482000                    DB      'CH ',$00           ; CHANNEL
0331 T B3E1 87                          GLO     R7                  ; GET CHANNEL NUMBER
0332 T B3E2 BF                          PHI     RF                  ; LOAD REGISTER
0333 T B3E3 6886D816                    SCAL    R6,TYPEH            ; PRINT CHANNEL NUMBER
0334 T B3E7 6886D800                    SCAL    R6,OSTRN1           ; PRINT MESSAGE
0335 T B3EB 202000                      DB      '  ',$00            ; SPACE OVER
0336 T B3EE 0A                          LDN     RA                  ; LOAD DATA
0337 T B3EF BD                          PHI     RD                  ; LOAD REGISTER
0338 T B3F0 6886D9B2                    SCAL    R6,WORD             ; DISPLAY AS BITS
0339 T B3F4 00                          DB      $00                 ; TERMINATION
0340 T B3F5 6886D800                    SCAL    R6,OSTRN1           ; PRINT MESSAGE
0341 T B3F9 202000                      DB      '  ',$00            ; SPACE OVER
0342 T B3FC 0A                          LDN     RA                  ; LOAD DATA
0343 T B3FD BF                          PHI     RF                  ; LOAD REGISTER
0344 T B3FE 6886D816                    SCAL    R6,TYPEH            ; DISPLAY AS HEX
0345                           
0346 T B402 6886D800                    SCAL    R6,OSTRN1           ; PRINT MESSAGE
0347 T B406 0A0D00                      DB      $0A,$0D,$00         ; NEW LINE
0348                           
0349 T B409 2A                          DEC     RA                  ; DECREMENT POINTER TO DATA
0350 T B40A 17                          INC     R7                  ; INCREMENT CHANNEL NUMBER
0351 T B40B 682BB3D9                    DBNZ    RB,OUTIT            ; LOOP FOR 8 CHANNELS
0352                           ;******************************************************************************
0353                           ;
0354                           ;       DELAY 15 SECONDS TO ALLOW FOR CHECK OR ABORT
0355                           ;
0356                           ;******************************************************************************
0357 T B40F 68C4000C                    RLDI    R4,$0C              ; LOAD OUTER COUNTER
0358 T B413 68C5FFFF           02$:     RLDI    R5,$FFFF            ; LOAD INNER COUNTER
0359 T B417 3F41               03$:     BN4     06$                 ; ABORT ON BREAK
0360 T B419 6825B417                    DBNZ    R5,03$              ; DECREMENT INNER COUNTER
0361 T B41D 6824B413                    DBNZ    R4,02$              ; DECREMENT OUTER COUNTER
0362                           
0363 T B421 6886DB40                    SCAL    R6,MLFCR            ; LINE UP
0364 T B425 10                          DB      $10                 ; 16 TIMES
0365                           ;******************************************************************************
0366                           ;
0367                           ;       INCREMENT OUTPUT DATA 1/4 FULL SCALE
0368                           ;
0369                           ;*****************************************************************************
0370 T B426 81                          GLO     R1                  ; GET DATA
0371 T B427 FFFF                        SMI     $FF                 ; OUTPUT DATA MAX
0372 T B429 3238                        BZ      05$                 ; IF DATA MAX, EXIT
0373                           
0374 T B42B 81                          GLO     R1                  ; GET DATA
0375 T B42C FC40                        ADI     $40                 ; ADD 1/4 FULL SCALE
0376 T B42E A1                          PLO     R1                  ; RESET DATA
0377                           
0378 T B42F 3A35                        BNZ     04$                 ; IF NOT ZERO OK, OTHERWISE ROLLED OVER
0379                           
0380 T B431 68C100FF                    RLDI    R1,$00FF            ; RESET DATA TO MAX 
0381                           
0382 T B435 C0B326             04$:     LBR     DATST1              ; LOOP 
0383                           ;******************************************************************************
0384                           ;
0385                           ;       REPEAT PROCESS
0386                           ;
0387                           ;*****************************************************************************
0388 T B438 6886D874           05$:     SCAL    R6,RCA1             ; SETUP TERMINAL I/O
0389 T B43C 6886DB1B                    SCAL    R6,CRLF             ; LINE DOWN
0390 T B440 0E                          DB      $0E                 ; 15 LINES
0391                           
0392 T B441 6886D800           06$:     SCAL    R6,OSTRN1           ; PRINT MESSAGE
0393 T B445 0A0D00                      DB      $0A,$0D,$00
0394 T B448 6886B700                    SCAL    R6,REPEAT           ; CALL REPEAT QUESTION ROUTINE
0395 T B44C C2B300                      LBZ     ADTST               ; REPEAT TEST IF D=0
0396                           ;******************************************************************************
0397                           ;
0398                           ;       RESET D/A OUTPUTS TO ZERO AND EXIT TO MAIN MENU
0399                           ;
0400                           ;*****************************************************************************
0401 T B44F 68C10000                    RLDI    R1,$0000            ; ZERO DATA
0402 T B453 68C24800                    RLDI    R2,RAM+$0800        ; SETUP INPUT STACK
0403 T B457 E3                          SEX     R3                  ; SET PROGRAM COUNTER EQUAL SP
0404 T B458 61                          OUT     1                   ; SET I/O GROUP
0405 T B459 30                          DB      $30                 ; I/O GROUP 30
0406 T B45A E2                          SEX     R2                  ; RESET SP TO R2
0407 T B45B 81                          GLO     R1                  ; GET DATA
0408 T B45C 52                          STR     R2                  ; STACK IT
0409 T B45D 63                          OUT     3                   ; OUTPUT DATA TO CHANNEL 1
0410 T B45E 22                          DEC     R2                  ; RESET STACK POINTER
0411 T B45F 64                          OUT     4                   ; OUTPUT DATA TO CHANNEL 2
0412 T B460 22                          DEC     R2                  ; RESET STACK POINTER
0413 T B461 C0B17A                      LBR     AMENU               ; RETURN TO A/D-D/A TEST MENU
0414                           ;******************************************************************************
0415                           ;
0416                           ;       END OF A/D-D/A TEST
0417                           ;
0418                           ;******************************************************************************
0419                           
0420 T B500                             CORG    $0100               ; SET NEXT PAGE
0421                           
0422                           ;*****************************************************************************
0423                           ;
0424                           ; A/D CALIBRATION
0425                           ;
0426                           ;******************************************************************************
0427 T B500 C4                 ADCAL:   NOP                         ; NO OPERATION
0428 T B501 6886DB6F                    SCAL    R6,CLEAR                ; CLEAR SCREEN
0429 T B505 6886D800                    SCAL    R6,OSTRN1               ; PRINT MESSAGE
0430 T B509 0A0D                        DB      $0A,$0D
0431 T B50B 4D42363534412041            DB      'MB654A A/D CALIBRATION'
            2F442043414C4942
            524154494F4E
0432 T B521 0A0A0A0A0D00                DB      $0A,$0A,$0A,$0A,$0D,$00
0433                           ;******************************************************************************
0434                           ;
0435                           ;       SETUP CYCLE COUNTER
0436                           ;
0437                           ;******************************************************************************
0438 T B527 6886DC23                    SCAL    R6,CUROFF               ; TURN OFF CURSOR
0439 T B52B 6886DB8E                    SCAL    R6,RVON                 ; REVERSE VIEDO
0440 T B52F 68C10200                    RLDI    R1,$0200                ; 512 TIMES
0441                           ;******************************************************************************
0442 T B533 E3                 ADCAL1:  SEX     R3                      ; SET PC EQUAL SP
0443 T B534 61                          OUT     1                       ; SELECT I/O GROUP
0444 T B535 30                          DB      $30                     ; I/O GROUP 30 IS A/D BOARD
0445 T B536 66                          OUT     6                       ; SELECT A/D MODE
0446 T B537 00                          DB      $00                     ; ZERO MEANS FIXED CHANNEL
0447 T B538 65                          OUT     5                       ; SELECT CHANNEL
0448 T B539 00                          DB      $00                     ; CHANNEL ZERO
0449 T B53A E2                          SEX     R2                      ; RESET SP TO R2
0450 T B53B 3C3B                        BN1     *                       ; WAIT FOR CONVERSION
0451 T B53D 6B                          INP     3                       ; INPUT CHANNEL ZERO
0452 T B53E BD                          PHI     RD                      ; LOAD REGISTER
0453 T B53F 6886D9AC                    SCAL    R6,WORD81               ; DISPLAY AS BITS
0454 T B543 01                          DB      $01                     ; TERMINATE WITH A CR
0455                           ;******************************************************************************
0456                           ;
0457                           ;       LOOP FOR NEXT SCAN
0458                           ;
0459                           ;******************************************************************************
0460 T B544 3F4A                        BN4     ADCAL2                  ; EXIT ON BREAK
0461 T B546 6821B533                    DBNZ    R1,ADCAL1               ; LOOP R1 TIMES
0462                           ;*****************************************************************************
0463                           ;
0464                           ;       REPEAT PROCESS
0465                           ;
0466                           ;*****************************************************************************
0467 T B54A 6886DB99           ADCAL2:  SCAL    R6,RVOFF            ; NORMAL VIDEO
0468 T B54E 6886DC18                    SCAL    R6,CURON            ; TURN CURSOR BACK ON
0469 T B552 6886B700                    SCAL    R6,REPEAT           ; CALL REPEAT QUESTION ROUTINE
0470 T B556 C2B500                      LBZ     ADCAL               ; REPEAT CALIBRATION IF D=0
0471 T B559 C0B17A                      LBR     AMENU               ; RETURN TO A/D-D/A TEST MENU
0472                           ;******************************************************************************
0473                           
0474 T B600                             CORG    $0100               ; SET TO NEXT PAGE
0475                           
0476                           ;******************************************************************************
0477                           ;
0478                           ;       D/A CALIBRATION
0479                           ;
0480                           ;******************************************************************************
0481 T B600 C4                 DACAL:   NOP                         ; NO OPERATION
0482 T B601 6886DB6F                    SCAL    R6,CLEAR            ; CLEAR SCREEN
0483 T B605 6886D800                    SCAL    R6,OSTRN1           ; PRINT MESSAGE
0484 T B609 0A0D                        DB      $0A,$0D
0485 T B60B 4D42363534412044            DB      'MB654A D/A CALIBRATION'
            2F412043414C4942
            524154494F4E
0486 T B621 0A0A0D                      DB      $0A,$0A,$0D
0487 T B624 0A0D00                      DB      $0A,$0D,$00
0488                           ;******************************************************************************
0489                           ;
0490                           ;       SETUP OUTPUT DATA
0491                           ;
0492                           ;******************************************************************************
0493 T B627 68C24FFF           DACAL1:  RLDI    R2,RAM+$0FFF        ; RESET STACK POINTER FOR DEBUG ROUTINES
0494 T B62B 6886D800                    SCAL    R6,OSTRN1           ; PRINT MESSAGE
0495 T B62F 454E544552204845            DB      'ENTER HEX DATA FOR OUTPUT '
            5820444154412046
            4F52204F55545055
            5420
0496 T B649 00                          DB      $00
0497                           
0498 T B64A 6886B728                    SCAL    R6,CREAD            ; READ HEX DATA
0499 T B64E 3A27                        BNZ     DACAL1              ; RETRY ON NO HEX CHARACTER
0500                           
0501 T B650 8D                          GLO     RD                  ; GET BYTE
0502 T B651 A1                          PLO     R1                  ; SET INPUT BYTE
0503                           ;******************************************************************************
0504                           ;
0505                           ;       SETUP D/A I/O MODE
0506                           ;
0507                           ;******************************************************************************
0508 T B652 68C24800                    RLDI    R2,RAM+$0800        ; SETUP INPUT STACK
0509 T B656 E3                          SEX     R3                  ; SET PROGRAM COUNTER EQUAL SP
0510 T B657 61                          OUT     1                   ; SET I/O GROUP
0511 T B658 30                          DB      $30                 ; I/O GROUP 30
0512 T B659 E2                          SEX     R2                  ; RESET SP TO R2
0513                           ;******************************************************************************
0514                           ;
0515                           ;       OUTPUT DATA TO D/A CHANNELS 1 AND TWO
0516                           ;
0517                           ;******************************************************************************
0518 T B65A 81                          GLO     R1                  ; GET DATA
0519 T B65B 52                          STR     R2                  ; STACK IT
0520 T B65C 63                          OUT     3                   ; OUTPUT DATA TO CHANNEL 1
0521 T B65D 22                          DEC     R2                  ; RESET STACK POINTER
0522 T B65E 64                          OUT     4                   ; OUTPUT DATA TO CHANNEL 2
0523 T B65F 22                          DEC     R2                  ; RESET STACK POINTER
0524                           ;******************************************************************************
0525                           ;
0526                           ;       DISPLAY OUTPUT DATA
0527                           ;
0528                           ;******************************************************************************
0529 T B660 68C24FFF                    RLDI    R2,RAM+$0FFF        ; RESET STACK POINTER FOR DEBUG ROUTINES
0530 T B664 68C70001                    RLDI    R7,$0001            ; SET INITIAL CHANNEL NUMBER
0531 T B668 68CB0002                    RLDI    RB,$0002            ; TWO CHANNELS
0532                                            
0533 T B66C 6886D800                    SCAL    R6,OSTRN1           ; PRINT MESSAGE
0534 T B670 0A0A0D                      DB      $0A,$0A,$0D
0535 T B673 00                          DB      $00     
0536                           
0537 T B674 6886D800           01$:     SCAL    R6,OSTRN1           ; PRINT MESSAGE
0538 T B678 43482000                    DB      'CH ',$00           ; CHANNEL
0539 T B67C 87                          GLO     R7                  ; GET CHANNEL NUMBER
0540 T B67D BF                          PHI     RF                  ; LOAD REGISTER
0541 T B67E 6886D816                    SCAL    R6,TYPEH            ; PRINT CHANNEL NUMBER
0542 T B682 6886D800                    SCAL    R6,OSTRN1           ; PRINT MESSAGE
0543 T B686 202000                      DB      '  ',$00            ; SPACE OVER
0544 T B689 81                          GLO     R1                  ; LOAD DATA
0545 T B68A BD                          PHI     RD                  ; LOAD REGISTER
0546 T B68B 6886D9B2                    SCAL    R6,WORD             ; DISPLAY AS BITS
0547 T B68F 00                          DB      $00                 ; TERMINATION
0548 T B690 6886D800                    SCAL    R6,OSTRN1           ; PRINT MESSAGE
0549 T B694 202000                      DB      '  ',$00            ; SPACE OVER
0550 T B697 81                          GLO     R1                  ; LOAD DATA
0551 T B698 BF                          PHI     RF                  ; LOAD REGISTER
0552 T B699 6886D816                    SCAL    R6,TYPEH            ; DISPLAY AS HEX
0553                           
0554 T B69D 6886D800                    SCAL    R6,OSTRN1           ; PRINT MESSAGE
0555 T B6A1 0A0D00                      DB      $0A,$0D,$00         ; NEW LINE
0556                           
0557 T B6A4 17                          INC     R7                  ; INCREMENT CHANNEL NUMBER
0558 T B6A5 682BB674                    DBNZ    RB,01$              ; LOOP FOR 2 CHANNELS
0559                           ;******************************************************************************
0560                           ;
0561                           ;       DELAY 15 SECONDS FOR CHECK OR ABORT
0562                           ;
0563                           ;******************************************************************************
0564 T B6A9 68CE000C                    RLDI    RE,$0C              ; LOAD OUTER COUNTER
0565 T B6AD 68CFFFFF           02$:     RLDI    RF,$FFFF            ; LOAD INNER COUNTER
0566 T B6B1 3FC7               03$:     BN4     05$                 ; ABORT ON BREAK
0567 T B6B3 682FB6B1                    DBNZ    RF,03$              ; DECREMENT INNER COUNTER
0568 T B6B7 682EB6AD                    DBNZ    RE,02$              ; DECREMENT OUTER COUNTER
0569                           
0570 T B6BB 6886D874                    SCAL    R6,RCA1             ; SETUP FOR TERMINAL I/O
0571 T B6BF 6886DB40                    SCAL    R6,MLFCR            ; LINE UP
0572 T B6C3 04                          DB      $04                 ; 4 TIMES
0573                           ;******************************************************************************
0574                           ;
0575                           ;       REPEAT CYCLE
0576                           ;
0577                           ;*****************************************************************************
0578 T B6C4 C0B627                      LBR     DACAL1              ; LOOP
0579                           ;******************************************************************************
0580                           ;
0581                           ;       REPEAT PROCESS
0582                           ;
0583                           ;*****************************************************************************
0584 T B6C7 6886D800           05$:     SCAL    R6,OSTRN1           ; PRINT MESSAGE
0585 T B6CB 0A0A0D00                    DB      $0A,$0A,$0D,$00     ; 2 LINES DOWN
0586 T B6CF 6886B700                    SCAL    R6,REPEAT           ; CALL REPEAT QUESTION ROUTINE
0587 T B6D3 C2B600                      LBZ     DACAL               ; REPEAT TEST IF D=0
0588 T B6D6 C0B17A                      LBR     AMENU               ; RETURN TO A/D-D/A TEST MENU
0589                           ;******************************************************************************
0590                           
0591 T B700                             CORG    $0100               ; SET NEXT PAGE
0592                           
0593                           ;******************************************************************************
0594                           ;
0595                           ;       REPEAT PROCESS QUESTION ROUTINE
0596                           ;
0597                           ;******************************************************************************
0598 T B700 6886D800           REPEAT:  SCAL    R6,OSTRN1           ; PRINT MESSAGE
0599 T B704 0A0A0D                      DB      $0A,$0A,$0D
0600 T B707 5245504541542054            DB      'REPEAT TEST (Y OR N) ? ',$00
            455354202859204F
            52204E29203F2000
0601                           
0602 T B71F 6886D904                    SCAL    R6,READD            ; READ AFTER DELAY
0603 T B723 9F                          GHI     RF                  ; GET USER INPUT
0604 T B724 FF59                        SMI     'Y'                 ; YES
0605 T B726 6896                        SRET    R6                  ; RETURN D=0 FOR YES
0606                           ;******************************************************************************
0607                           ;
0608                           ;       CUSTOM HEX READER ROUTINE
0609                           ;
0610                           ;******************************************************************************
0611 T B728 6886D8B8           CREAD:   SCAL    R6,READH1           ; CALL READER
0612 T B72C 3328                        BDF     CREAD               ; WAIT FOR INPUT
0613 T B72E 9F                          GHI     RF                  ; CHECK ASCII
0614 T B72F FB0D                        XRI     $0D                 ; IS IT A CR?
0615 T B731 3A35                        BNZ     01$                 ; IF NON HEX ERROR
0616 T B733 6896                        SRET    R6                  ; RETURN WITH RESULT IN RD
0617                           
0618 T B735 6886D800           01$:     SCAL    R6,OSTRN1           ; PRINT MESSAGE
0619 T B739 0D00                        DB      $0D,$00             ; RESET TO START OF LINE
0620 T B73B F8FF                        LDI     $FF                 ; SET D WITH SOME NON-ZERO VAULE
0621 T B73D 6896                        SRET    R6                  ; RETURN
0622                           ;******************************************************************************
0623                           
0624 T B800                             CORG    $0100               ; SET NEXT PAGE
0625                           
0626                           ;******************************************************************************
0627                           ;
0628                           ;       CPU TEST 
0629                           ;
0630                           ;******************************************************************************
0631 T B800 C4                 CPUTST:  NOP                         ; NO OPERATION
0632 T B801 68C10000                    RLDI    R1,$0000            ; ZERO OUT GLOBAL ERROR COUNTER
0633                           ;******************************************************************************
0634                           ;
0635                           ;       TEST RAM AT $4000
0636                           ;
0637                           ;******************************************************************************
0638 T B805 6886DB6F                    SCAL    R6,CLEAR            ; CLEAR SCREEN
0639 T B809 6886D800                    SCAL    R6,OSTRN1           ; PRINT MESSAGE
0640 T B80D 0A0D                        DB      $0A,$0D
0641 T B80F 54455354494E4720            DB      'TESTING RAM ON CPU BOARD'
            52414D204F4E2043
            505520424F415244
0642 T B827 0A0A0D                      DB      $0A,$0A,$0D
0643 T B82A 504C454153452057            DB      'PLEASE WAIT...'
            4149542E2E2E
0644 T B838 0A0A0D00                    DB      $0A,$0A,$0D,$00
0645                           
0646 T B83C 68C00000                    RLDI    R0,$0000            ; ZERO OUT ERROR COUNT
0647                           
0648 T B840 68C84000                    RLDI    R8,RAM              ; BASE ADDRESSS FOR CPU RAM
0649 T B844 68C90FFF                    RLDI    R9,$0FFF            ; NUMBER OF BYTES
0650 T B848 F800               RAMTST:  LDI     $00                 ; ZERO BYTE
0651 T B84A 58                          STR     R8                  ; STORE IN RAM
0652 T B84B C4                          NOP                         ;
0653 T B84C C4                          NOP                         ;
0654                                            
0655 T B84D 3FB5                        BN4     04$                 ; ABORT ON BREAK
0656                           
0657 T B84F C4                          NOP                         ;
0658 T B850 C4                          NOP                         ;
0659 T B851 08                          LDN     R8                  ; GET BYTE FROM RAM
0660 T B852 3258                        BZ      01$                 ; CHECK OK?
0661                           
0662 T B854 6886BDDA                    SCAL    R6,ERRRAM           ; REPORT RAM ERROR
0663                           
0664 T B858 F8FF               01$:     LDI     $FF                 ; ALL ONES
0665 T B85A 58                          STR     R8                  ; STORE IN RAM
0666 T B85B C4                          NOP                         ;
0667 T B85C C4                          NOP                         ;
0668                           
0669 T B85D 3FB5                        BN4     04$                 ; ABORT ON BREAK
0670                                            
0671 T B85F C4                          NOP                         ;
0672 T B860 C4                          NOP                         ;
0673 T B861 08                          LDN     R8                  ; GET BYTE FROM RAM
0674 T B862 FFFF                        SMI     $FF                 ;
0675 T B864 326A                        BZ      02$                 ; CHECK OK
0676                           
0677 T B866 6886BDDA                    SCAL    R6,ERRRAM           ; REPORT RAM ERROR
0678                                            
0679 T B86A 18                 02$:     INC     R8                  ; INCREMENT RAM ADDRESS
0680 T B86B 6829B848                    DBNZ    R9,RAMTST           ; CHECK 4K BYTE
0681                           
0682 T B86F 90                          GHI     R0                  ; HIGH BYTE OF ERROR COUNT
0683 T B870 3A91                        BNZ     03$                 ; IF ERROR BRANCH
0684 T B872 80                          GLO     R0                  ; LOW BYTE OF ERROR COUNT
0685 T B873 3A91                        BNZ     03$                 ; JUMP TO EPROM TEST IF NO ERRORS
0686                           
0687 T B875 6886D800                    SCAL    R6,OSTRN1           ; PRINT MESSAGE
0688 T B879 0A0D                        DB      $0A,$0D
0689 T B87B 52414D2054455354            DB      'RAM TEST COMPLETED'
            20434F4D504C4554
            4544
0690 T B88D 00                          DB      $00
0691 T B88E C0B8F6                      LBR     EPTST               ; JUMP TO EPROM TEST IF NO ERRORS
0692                           
0693 T B891 6886D800           03$:     SCAL    R6,OSTRN1           ; PRINT MESSAGE
0694 T B895 0A0D                        DB      $0A,$0D
0695 T B897 2A2A2A2A2052414D            DB      '**** RAM TEST ERRORS ****'
            2054455354204552
            524F5253202A2A2A
            2A
0696 T B8B0 0A0D00                      DB      $0A,$0D,$00
0697 T B8B3 30D8                        BR      05$                 ; WAIT FOR KEY
0698                                            
0699 T B8B5 6886D800           04$:     SCAL    R6,OSTRN1           ; PRINT MESSAGE
0700 T B8B9 0A0D                        DB      $0A,$0D
0701 T B8BB 2A2A2A2A2052414D            DB      '**** RAM TEST ABORTED ****'
            2054455354204142
            4F52544544202A2A
            2A2A
0702 T B8D5 0A0D00                      DB      $0A,$0D,$00
0703                           
0704 T B8D8 6886D800           05$:     SCAL    R6,OSTRN1           ; PRINT MESSAGE
0705 T B8DC 2020202020205052            DB      '      PRESS ANY KEY'
            45535320414E5920
            4B4559
0706 T B8EF 0A0D00                      DB      $0A,$0D,$00
0707 T B8F2 6886D904                    SCAL    R6,READD            ; SCAN KEYBOARD
0708                           ;******************************************************************************
0709                           ;
0710                           ;       COMPARE EPROM AT $0000 TO MASTER AT $C000
0711                           ;
0712                           ;******************************************************************************
0713 T B8F6 6886DB6F           EPTST:   SCAL    R6,CLEAR            ; CLEAR SCREEN
0714 T B8FA 6886D800                    SCAL    R6,OSTRN1           ; PRINT MESSAGE
0715 T B8FE 0A0D                        DB      $0A,$0D
0716 T B900 434845434B204550            DB      'CHECK EPROM AGAINST MASTER'
            524F4D2041474149
            4E5354204D415354
            4552
0717 T B91A 0A0A0D                      DB      $0A,$0A,$0D
0718 T B91D 504C454153452057            DB      'PLEASE WAIT...'
            4149542E2E2E
0719 T B92B 0A0A0D00                    DB      $0A,$0A,$0D,$00
0720                           
0721 T B92F 68C00000                    RLDI    R0,$0000            ; ZERO OUT ERROR COUNT
0722                           
0723 T B933 68C7C800                    RLDI    R7,MASTER           ; STORAGE ADDREES FOR EPROM CODE
0724 T B937 68C80000                    RLDI    R8,$0000            ; BASE ADDRESS FOR EPROM CODE
0725 T B93B 68C907FF                    RLDI    R9,$07FF            ; NUMBER OF BYTES
0726                           
0727 T B93F E8                 01$:     SEX     R8                  ; POINTER TO EPROM IS SP
0728 T B940 07                          LDN     R7                  ; GET BYTE FORM MASTER
0729 T B941 F7                          SM                          ; SUBTRACK FORM EPROM
0730 T B942 E2                          SEX     R2                  ; RESET SP TO R2
0731 T B943 3249                        BZ      02$                 ; CHECK OK?
0732                           
0733 T B945 6886BE04                    SCAL    R6,ERRCOM           ; IF NOT EQUAL ERROR
0734                           
0735 T B949 3F9D               02$:     BN4     04$                 ; ABORT ON BREAK
0736 T B94B 17                          INC     R7                  ; INCREMENT ADDRESS OF EPROM
0737 T B94C 18                          INC     R8                  ; INCREMENT ADDRESS OF MASTER
0738 T B94D 6829B93F                    DBNZ    R9,01$              ; COMPARE 2K BYTES
0739                           
0740 T B951 90                          GHI     R0                  ; HIGH BYTE OF ERROR COUNT
0741 T B952 3A75                        BNZ     03$                 ; IF ERROR BRANCH
0742 T B954 80                          GLO     R0                  ; LOW BYTE OF ERROR COUNT
0743 T B955 3A75                        BNZ     03$                 ; IF NOT ZERO ERRORS
0744                           
0745 T B957 6886D800                    SCAL    R6,OSTRN1           ; PRINT MESSAGE
0746 T B95B 0A0D                        DB      $0A,$0D
0747 T B95D 4550524F4D205445            DB      'EPROM TEST COMPLETED'
            535420434F4D504C
            45544544
0748 T B971 00                          DB      $00
0749 T B972 C0B9E0                      LBR     PIOTST              ; JUMP TO PIO TEST IF NO ERRORS
0750                           
0751 T B975 6886D800           03$:     SCAL    R6,OSTRN1           ; PRINT MESSAGE
0752 T B979 0A0D                        DB      $0A,$0D
0753 T B97B 2A2A2A2A20455052            DB      '**** EPROM VERIFY ERRORS ****'
            4F4D205645524946
            59204552524F5253
            202A2A2A2A
0754 T B998 0A0D00                      DB      $0A,$0D,$00
0755 T B99B 30C2                        BR      05$                 ; WAIT FOR KEY
0756                           
0757 T B99D 6886D800           04$:     SCAL    R6,OSTRN1           ; PRINT MESSAGE
0758 T B9A1 0A0D                        DB      $0A,$0D
0759 T B9A3 2A2A2A2A20455052            DB      '**** EPROM TEST ABORTED ****'
            4F4D205445535420
            41424F5254454420
            2A2A2A2A
0760 T B9BF 0A0D00                      DB      $0A,$0D,$00
0761                           
0762 T B9C2 6886D800           05$:     SCAL    R6,OSTRN1           ; PRINT MESSAGE
0763 T B9C6 2020202020205052            DB      '      PRESS ANY KEY'
            45535320414E5920
            4B4559
0764 T B9D9 0A0D00                      DB      $0A,$0D,$00
0765 T B9DC 6886D904                    SCAL    R6,READD            ; SCAN KEYBOARD
0766                           ;******************************************************************************
0767                           ;
0768                           ;       PIO TEST
0769                           ;
0770                           ;******************************************************************************
0771 T B9E0 6886DB6F           PIOTST:  SCAL    R6,CLEAR            ; CLEAR SCREEN
0772 T B9E4 6886D800                    SCAL    R6,OSTRN1           ; PRINT MESSAGE
0773 T B9E8 0A0D                        DB      $0A,$0D
0774 T B9EA 54455354494E4720            DB      'TESTING PROGRAMMABLE I/O CHIP'
            50524F4752414D4D
            41424C4520492F4F
            2043484950
0775 T BA07 0A0A0D                      DB      $0A,$0A,$0D
0776 T BA0A 504C454153452057            DB      'PLEASE WAIT...'
            4149542E2E2E
0777 T BA18 0A0A0D00                    DB      $0A,$0A,$0D,$00
0778                           
0779 T BA1C 68C00000                    RLDI    R0,$0000            ; ZERO OUT ERROR COUNT
0780                           
0781                           ;******************************************************************************
0782                           ;
0783                           ;       SETUP PIO PORTS
0784                           ;
0785                           ;******************************************************************************
0786 T BA20 E3                          SEX     R3                  ; SET SP TO PC
0787 T BA21 61                          OUT     1                   ; SELECT I/O GROUP
0788 T BA22 08                          DB      $08                 ; PIO CHIP
0789 T BA23 62                          OUT     2                   ; SETUP PORT A FOR INPUT
0790 T BA24 0F                          DB      $0F
0791 T BA25 62                          OUT     2                   ; SETUP PORT B FOR OUTPUT
0792 T BA26 77                          DB      $77
0793 T BA27 E2                          SEX     R2                  ; RESET SP
0794                           ;******************************************************************************
0795                           ;
0796                           ;       TEST PIO PORTS
0797                           ;
0798                           ;******************************************************************************
0799 T BA28 68C70100                    RLDI    R7,$0100            ; COUNTER
0800 T BA2C 68C800FF                    RLDI    R8,$00FF            ; DATA
0801                           
0802 T BA30 E3                 01$:     SEX     R3                  ; SET SP TO PC
0803 T BA31 61                          OUT     1                   ; SET I/O GROUP
0804 T BA32 08                          DB      $08                 ; PIO CHIP
0805 T BA33 E2                          SEX     R2                  ; RESET SP
0806                           
0807 T BA34 88                          GLO     R8                  ; GET DATA
0808 T BA35 52                          STR     R2                  ; STACK IT
0809 T BA36 66                          OUT     6                   ; OUTPUT DATA FROM PORT B
0810 T BA37 22                          DEC     R2                  ; RESET SP
0811                           
0812 T BA38 C4                          NOP                         ; NO OPERATION
0813 T BA39 C4                          NOP                         ;
0814 T BA3A 3F92                        BN4     04$                 ; ABORT ON BREAK KEY
0815 T BA3C C4                          NOP                         ;
0816 T BA3D C4                          NOP                         ;
0817                           
0818 T BA3E 6C                          INP     4                   ; READ PORT A
0819 T BA3F 88                          GLO     R8                  ; GET DATA
0820 T BA40 F7                          SM                          ; DATA OUT - DATA IN
0821 T BA41 3247                        BZ      02$                 ; IF ZERO OK
0822                           
0823 T BA43 6886BE30                    SCAL    R6,ERRIO            ; REPORT I/O ERRORS
0824                           
0825 T BA47 28                 02$:     DEC     R8                  ; DECREMENT DATA
0826 T BA48 6827BA30                    DBNZ    R7,01$              ; LOOP TILL ALL DATA TESTED
0827                           
0828 T BA4C 90                          GHI     R0                  ; HIGH BYTE OF ERROR COUNT
0829 T BA4D 3A6E                        BNZ     03$                 ; IF ERROR BRANCH
0830 T BA4F 80                          GLO     R0                  ; LOW BYTE OF ERROR COUNT
0831 T BA50 3A6E                        BNZ     03$                 ; IF NOT ZERO ERRORS
0832                           
0833 T BA52 6886D800                    SCAL    R6,OSTRN1           ; PRINT MESSAGE
0834 T BA56 0A0D                        DB      $0A,$0D
0835 T BA58 492F4F2054455354            DB      'I/O TEST COMPLETED'
            20434F4D504C4554
            4544
0836 T BA6A 00                          DB      $00
0837 T BA6B C0BAD3                      LBR     EFNTST              ; JUMP TO EVENT FLAG TEST IF NO ERRORS
0838                           
0839 T BA6E 6886D800           03$:     SCAL    R6,OSTRN1           ; PRINT MESSAGE
0840 T BA72 0A0D                        DB      $0A,$0D
0841 T BA74 2A2A2A2A20492F4F            DB      '**** I/O TEST ERRORS ****'
            2054455354204552
            524F5253202A2A2A
            2A
0842 T BA8D 0A0D00                      DB      $0A,$0D,$00
0843 T BA90 30B5                        BR      05$                 ; WAIT FOR KEY
0844                           
0845 T BA92 6886D800           04$:     SCAL    R6,OSTRN1           ; PRINT MESSAGE
0846 T BA96 0A0D                        DB      $0A,$0D
0847 T BA98 2A2A2A2A20492F4F            DB      '**** I/O TEST ABORTED ****'
            2054455354204142
            4F52544544202A2A
            2A2A
0848 T BAB2 0A0D00                      DB      $0A,$0D,$00
0849                           
0850 T BAB5 6886D800           05$:     SCAL    R6,OSTRN1           ; PRINT MESSAGE
0851 T BAB9 2020202020205052            DB      '      PRESS ANY KEY'
            45535320414E5920
            4B4559
0852 T BACC 0A0D00                      DB      $0A,$0D,$00
0853 T BACF 6886D904                    SCAL    R6,READD            ; SCAN KEYBOARD
0854                           ;******************************************************************************
0855                           ;
0856                           ;      EVENT FLAG TEST
0857                           ;
0858                           ;******************************************************************************
0859 T BAD3 6886DB6F           EFNTST:  SCAL    R6,CLEAR            ; CLEAR SCREEN
0860 T BAD7 6886D800                    SCAL    R6,OSTRN1           ; PRINT MESSAGE
0861 T BADB 0A0D                        DB      $0A,$0D
0862 T BADD 54455354494E4720            DB      'TESTING EVENT FLAGS'
            4556454E5420464C
            414753
0863 T BAF0 0A0A0D                      DB      $0A,$0A,$0D
0864 T BAF3 504C454153452057            DB      'PLEASE WAIT...'
            4149542E2E2E
0865 T BB01 0A0A0D00                    DB      $0A,$0A,$0D,$00
0866                           
0867 T BB05 68C00000                    RLDI    R0,$0000            ; ZERO OUT ERROR COUNT
0868                           
0869                           ;******************************************************************************
0870 T BB09 E3                          SEX     R3                  ; SET SP TO PC
0871 T BB0A 61                          OUT     1                   ; SELECT I/O GROUP
0872 T BB0B 08                          DB      $08                 ; PIO CHIP
0873 T BB0C E2                          SEX     R2                  ; RESET SP
0874                           
0875 T BB0D 68C80001                    RLDI    R8,$0001            ; EVENT FLAG COUNTER
0876                           
0877 T BB11 F800                        LDI     $00                 ; ZERO BYTE
0878 T BB13 52                          STR     R2                  ; STACK IT
0879 T BB14 66                          OUT     6                   ; OUTPUT DATA
0880 T BB15 22                          DEC     R2                  ; RESET SP
0881                                            
0882 T BB16 341E                        B1      10$                 ; EF1 SHALL BE ZERO - REV
0883 T BB18 6886BE5A                    SCAL    R6,ERREF            ; DISPLAY ERROR
0884 T BB1C 3FAB                        BN4     04$                 ; ABORT ON BREAK
0885                                            
0886 T BB1E 18                 10$:     INC     R8                  ; INCREMENT EVENT FLAG COUNTER
0887 T BB1F 3527                        B2      20$                 ; EF2 SHALL BE ZERO - REV
0888 T BB21 6886BE5A                    SCAL    R6,ERREF            ; DISPLAY ERROR
0889 T BB25 3FAB                        BN4     04$                 ; ABORT ON BREAK
0890                           
0891 T BB27 18                 20$:     INC     R8                  ; INCREMENT EVENT FLAG COUNTER
0892 T BB28 3630                        B3      30$                 ; EF3 SHALL BE ZERO - REV
0893 T BB2A 6886BE5A                    SCAL    R6,ERREF            ; DISPLAY ERROR
0894 T BB2E 3FAB                        BN4     04$                 ; ABORT ON BREAK
0895                           
0896 T BB30 E3                 30$:     SEX     R3                  ; SET SP TO PC
0897 T BB31 61                          OUT     1                   ; SELCT I/O GROUP
0898 T BB32 08                          DB      $08                 ; PIO CHIP
0899 T BB33 E2                          SEX     R2                  ; RESET SP
0900                           
0901 T BB34 68C8FF01                    RLDI    R8,$FF01            ; EVENT FLAG COUNTER
0902                           
0903 T BB38 F8FF                        LDI     $FF                 ; DATA BYTE
0904 T BB3A 52                          STR     R2                  ; STACK IT
0905 T BB3B 66                          OUT     6                   ; OUTPUT DATA
0906 T BB3C 22                          DEC     R2                  ; RESET SP
0907                           
0908 T BB3D 3C45                        BN1     11$                 ; EF1 SHALL BE HIGH - REV
0909 T BB3F 6886BE5A                    SCAL    R6,ERREF            ; DISPLAY ERROR
0910 T BB43 3FAB                        BN4     04$                 ; ABORT ON BREAK
0911                           
0912 T BB45 18                 11$:     INC     R8                  ; INCREMENT EVENT FLAG COUNTER
0913 T BB46 3D4E                        BN2     12$                 ; EF2 SHALL BE HIGH - REV
0914 T BB48 6886BE5A                    SCAL    R6,ERREF            ; DISPLAY ERROR
0915 T BB4C 3FAB                        BN4     04$                 ; ABORT ON BREAK
0916                           
0917 T BB4E 18                 12$:     INC     R8                  ; INCREMENT EVENT FLAG COUNTER
0918 T BB4F 3E57                        BN3     13$                 ; EF3 SHALL BE HIGH - REV
0919 T BB51 6886BE5A                    SCAL    R6,ERREF            ; DISPLAY ERROR
0920 T BB55 3FAB                        BN4     04$                 ; ABORT ON BREAK
0921                           
0922 T BB57 90                 13$:     GHI     R0                  ; HIGH BYTE OF ERROR COUNT
0923 T BB58 3A80                        BNZ     03$                 ; IF ERROR BRANCH
0924 T BB5A 80                          GLO     R0                  ; LOW BYTE OF ERROR COUNT
0925 T BB5B 3A80                        BNZ     03$                 ; IF NOT ZERO ERRORS
0926                           
0927 T BB5D 6886D800                    SCAL    R6,OSTRN1           ; PRINT MESSAGE
0928 T BB61 0A0D                        DB      $0A,$0D
0929 T BB63 4556454E5420464C            DB      'EVENT FLAG TEST COMPLETED'
            4147205445535420
            434F4D504C455445
            44
0930 T BB7C 00                          DB      $00
0931 T BB7D C0BBF3                      LBR     CLKTST              ; JUMP TO CLOCK TEST IF NO ERRORS
0932                           
0933 T BB80 6886D800           03$:     SCAL    R6,OSTRN1           ; PRINT MESSAGE
0934 T BB84 0A0D                        DB      $0A,$0D
0935 T BB86 2A2A2A2A20455645            DB      '**** EVENT FLAG TEST ERRORS ****'
            4E5420464C414720
            5445535420455252
            4F5253202A2A2A2A
0936 T BBA6 0A0D00                      DB      $0A,$0D,$00
0937 T BBA9 30D5                        BR      05$                 ; WAIT FOR KEY
0938                           
0939 T BBAB 6886D800           04$:     SCAL    R6,OSTRN1           ; PRINT MESSAGE
0940 T BBAF 0A0D                        DB      $0A,$0D
0941 T BBB1 2A2A2A2A20455645            DB      '**** EVENT FLAG TEST ABORTED ****'
            4E5420464C414720
            544553542041424F
            52544544202A2A2A
            2A
0942 T BBD2 0A0D00                      DB      $0A,$0D,$00
0943                           
0944 T BBD5 6886D800           05$:     SCAL    R6,OSTRN1           ; PRINT MESSAGE
0945 T BBD9 2020202020205052            DB      '      PRESS ANY KEY'
            45535320414E5920
            4B4559
0946 T BBEC 0A0D00                      DB      $0A,$0D,$00
0947 T BBEF 6886D904                    SCAL    R6,READD            ; SCAN KEYBOARD
0948                           ;******************************************************************************
0949                           ;
0950                           ;       CLOCK - COUNTER TEST
0951                           ;
0952                           ;******************************************************************************
0953 T BBF3 6886DB6F           CLKTST:  SCAL    R6,CLEAR            ; CLEAR SCREEN
0954 T BBF7 6886D800                    SCAL    R6,OSTRN1           ; PRINT MESSAGE
0955 T BBFB 0A0D                        DB      $0A,$0D
0956 T BBFD 54455354494E4720            DB      'TESTING CLOCK-COUNTER'
            434C4F434B2D434F
            554E544552
0957 T BC12 0A0A0D                      DB      $0A,$0A,$0D
0958 T BC15 504C454153452057            DB      'PLEASE WAIT...'
            4149542E2E2E
0959 T BC23 0A0A0D00                    DB      $0A,$0A,$0D,$00
0960                           
0961 T BC27 68C00000                    RLDI    R0,$0000            ; ZERO OUT ERROR COUNT
0962                           
0963                           ;******************************************************************************
0964                           ;
0965                           ;       SET UP CLOCK COUNTER
0966                           ;
0967                           ;******************************************************************************
0968 T BC2B 6800                        STPC                        ; STOP COUNTER
0969 T BC2D F840                        LDI     $40                 ; 64 COUNTS
0970 T BC2F 6806                        LDC                         ; LOAD COUNTER
0971 T BC31 6809                        ETQ                         ; ENABLE Q FLIP/FLOP
0972 T BC33 6803                        SCM2                        ; START COUNTER MODE 2
0973                           ;******************************************************************************
0974 T BC35 7B                          SEQ                         ; SET Q=1
0975 T BC36 68C70050                    RLDI    R7,$0040+$10        ; 80 COUNTS
0976 T BC3A E3                          SEX     R3                  ; SET SP TO PC
0977 T BC3B 61                          OUT     1                   ; SELECT I/O GROUP
0978 T BC3C 08                          DB      $08                 ; PIO CHIP
0979 T BC3D E2                          SEX     R2                  ; RESET SP
0980                           ;******************************************************************************
0981 T BC3E F8FF               01$:     LDI     $FF                 ; HIGH DATA
0982 T BC40 52                          STR     R2                  ; STACK IT
0983 T BC41 66                          OUT     6                   ; OUTPUT TO PORT B
0984 T BC42 22                          DEC     R2                  ; RESET SP
0985                           
0986 T BC43 C4                          NOP                         ; NO OPERATION
0987 T BC44 C4                          NOP                         ;
0988 T BC45 3FB8                        BN4     04$                 ; ABORT ON BREAK
0989 T BC47 C4                          NOP                         ;
0990 T BC48 C4                          NOP                         ;
0991                           
0992 T BC49 F800                        LDI     $00                 ; ZERO DATA
0993 T BC4B 52                          STR     R2                  ; STACK IT
0994 T BC4C 66                          OUT     6                   ; OUTPUT TO PORT B
0995 T BC4D 22                          DEC     R2                  ; RESET SP
0996                           
0997 T BC4E C4                          NOP                         ; NO OPERATION
0998 T BC4F C4                          NOP                         ;
0999 T BC50 3FB8                        BN4     04$                 ; ABORT ON BREAK
1000 T BC52 C4                          NOP                         ;
1001 T BC53 C4                          NOP                         ;
1002                           
1003 T BC54 6827BC3E                    DBNZ    R7,01$              ; LOOP FOR 42 CYCLES
1004                           ;******************************************************************************
1005                           ;
1006                           ;       ON EXIT FROM LOOP Q SHALL BE LOW
1007                           ;
1008                           ;******************************************************************************
1009 T BC58 395E                        BNQ     02$                 ; IF Q NOT LOW ERROR
1010                           
1011 T BC5A 6886BE81                    SCAL    R6,ERRCLK           ; DISPLAY ERROR
1012                           
1013 T BC5E 90                 02$:     GHI     R0                  ; HIGH BYTE OF ERROR COUNT
1014 T BC5F 3A8A                        BNZ     03$                 ; IF ERROR BRANCH
1015 T BC61 80                          GLO     R0                  ; LOW BYTE OF ERROR COUNT
1016 T BC62 3A8A                        BNZ     03$                 ; IF NOT ZERO ERRORS
1017                           
1018 T BC64 6886D800                    SCAL    R6,OSTRN1           ; PRINT MESSAGE
1019 T BC68 0A0D                        DB      $0A,$0D
1020 T BC6A 434C4F434B2D434F            DB      'CLOCK-COUNTER TEST COMPLETED'
            554E544552205445
            535420434F4D504C
            45544544
1021 T BC86 00                          DB      $00
1022 T BC87 C0BD03                      LBR     CPUEND              ; JUMP TO END OF TEST IF NO ERRORS
1023                           
1024 T BC8A 6886D800           03$:     SCAL    R6,OSTRN1           ; PRINT MESSAGE
1025 T BC8E 0A0D                        DB      $0A,$0D
1026 T BC90 2A2A2A2A20434C4F            DB      '**** CLOCK-COUNTER TEST ERRORS ****'
            434B2D434F554E54
            4552205445535420
            4552524F5253202A
            2A2A2A
1027 T BCB3 0A0D00                      DB      $0A,$0D,$00
1028 T BCB6 30E5                        BR      05$                 ; WAIT FOR KEY
1029                           
1030 T BCB8 6886D800           04$:     SCAL    R6,OSTRN1           ; PRINT MESSAGE
1031 T BCBC 0A0D                        DB      $0A,$0D
1032 T BCBE 2A2A2A2A20434C4F            DB      '**** CLOCK-COUNTER TEST ABORTED ****'
            434B2D434F554E54
            4552205445535420
            41424F5254454420
            2A2A2A2A
1033 T BCE2 0A0D00                      DB      $0A,$0D,$00
1034                           
1035 T BCE5 6886D800           05$:     SCAL    R6,OSTRN1           ; PRINT MESSAGE
1036 T BCE9 2020202020205052            DB      '      PRESS ANY KEY'
            45535320414E5920
            4B4559
1037 T BCFC 0A0D00                      DB      $0A,$0D,$00
1038 T BCFF 6886D904                    SCAL    R6,READD            ; SCAN KEYBOARD
1039                           ;******************************************************************************
1040                           ;
1041                           ;       END OF CPU TEST
1042                           ;
1043                           ;******************************************************************************
1044 T BD03 E2                 CPUEND:  SEX     R2                  ; RESET SP TO R2
1045 T BD04 6886DB6F                    SCAL    R6,CLEAR            ; CLEAR SCREEN
1046                           
1047 T BD08 91                          GHI     R1                  ; HIGH BYTE OF ERROR COUNT
1048 T BD09 3A35                        BNZ     03$                 ; IF ERROR BRANCH
1049 T BD0B 81                          GLO     R1                  ; LOW BYTE OF ERROR COUNT
1050 T BD0C 3A35                        BNZ     03$                 ; IF NOT ZERO ERRORS
1051                           
1052 T BD0E 6886D800                    SCAL    R6,OSTRN1           ; PRINT MESSAGE
1053 T BD12 0A0D                        DB      $0A,$0D
1054 T BD14 4D42363036203138            DB      'MB606 1805 CPU TEST COMPLETED'
            3035204350552054
            45535420434F4D50
            4C45544544
1055 T BD31 00                          DB      $00
1056 T BD32 C0B00C                      LBR     MENU                ; RETURN TO MAIN TEST MENU IF NO ERRORS
1057                           
1058 T BD35 6886D800           03$:     SCAL    R6,OSTRN1           ; PRINT MESSAGE
1059 T BD39 0A0D                        DB      $0A,$0D
1060 T BD3B 2A2A2A2A204D4236            DB      '**** MB606 1805 CPU TEST ERRORS ****'
            3036203138303520
            4350552054455354
            204552524F525320
            2A2A2A2A
1061 T BD5F 0A0A0D                      DB      $0A,$0A,$0D
1062 T BD62 2A2A2A2A2052454A            DB      '**** REJECT AND/OR RE-INSPECT *****'
            45435420414E442F
            4F522052452D494E
            5350454354202A2A
            2A2A2A
1063 T BD85 0A0A0D00                    DB      $0A,$0A,$0D,$00
1064 T BD89 30B9                        BR      05$                 ; WAIT FOR KEY
1065                           
1066 T BD8B 6886D800           04$:     SCAL    R6,OSTRN1           ; PRINT MESSAGE
1067 T BD8F 0A0D                        DB      $0A,$0D
1068 T BD91 2A2A2A2A204D4236            DB      '**** MB606 1805 CPU TEST ABORTED ****'
            3036203138303520
            4350552054455354
            2041424F52544544
            202A2A2A2A
1069 T BDB6 0A0D00                      DB      $0A,$0D,$00
1070                           
1071 T BDB9 6886D800           05$:     SCAL    R6,OSTRN1           ; PRINT MESSAGE
1072 T BDBD 2020202020205052            DB      '      PRESS ANY KEY'
            45535320414E5920
            4B4559
1073 T BDD0 0A0D00                      DB      $0A,$0D,$00
1074 T BDD3 6886D904                    SCAL    R6,READD            ; SCAN KEYBOARD
1075 T BDD7 C0B00C                      LBR     MENU                ; RETURN TO MAIN MENU
1076                           ;******************************************************************************
1077                           ;
1078                           ;       CPU TEST ERROR ROURINES
1079                           ;
1080                           ;******************************************************************************
1081                           ;
1082                           ;       RAM VERIFY ERROR
1083                           ;
1084                           ;******************************************************************************
1085 T BDDA 6886D800           ERRRAM:  SCAL    R6,OSTRN1           ; PRINT MESSAGE
1086 T BDDE 52414D204641494C            DB      'RAM FAILURE AT ADDRESS '
            5552452041542041
            44445245535320
1087 T BDF5 00                          DB      $00
1088                                            
1089 T BDF6 98                          GHI     R8                  ; GET HIGH BYTE OF RAM ADDRESS
1090 T BDF7 BD                          PHI     RD                  ; PASS FOR PRINT
1091 T BDF8 88                          GLO     R8                  ; GET LOW BYTE OF RAM ADDRESS
1092 T BDF9 AD                          PLO     RD                  ; PASS FOR PRINT
1093 T BDFA 6886D950                    SCAL    R6,TYPE6            ; PRINT HEX ADDRESS
1094 T BDFE 0201                        DB      $02,$01             ; FOLLOW WITH ONE CRLF
1095 T BE00 10                          INC     R0                  ; INCREMENT LOCAL ERROR COUNTER
1096 T BE01 11                          INC     R1                  ; INCREMENT GOBAL ERROR COUNTER
1097 T BE02 6896                        SRET    R6                  ; RETURN
1098                           ;******************************************************************************
1099                           ;
1100                           ;       EPROM VERIFY ERROR
1101                           ;
1102                           ;******************************************************************************
1103 T BE04 6886D800           ERRCOM:  SCAL    R6,OSTRN1           ; PRINT MESSAGE
1104 T BE08 4550524F4D204641            DB      'EPROM FAILURE AT ADDRESS '
            494C555245204154
            2041444452455353
            20
1105 T BE21 00                          DB      $00
1106                           
1107 T BE22 98                          GHI     R8                  ; GET HIGH BYTE OF EPROM ADDRESS
1108 T BE23 BD                          PHI     RD                  ; PASS FOR PRINT
1109 T BE24 88                          GLO     R8                  ; GET LOW BYTE OF EPROM ADDRESS
1110 T BE25 AD                          PLO     RD                  ; PASS FOR PRINT
1111 T BE26 6886D950                    SCAL    R6,TYPE6            ; PRINT HEX ADDRESS
1112 T BE2A 0201                        DB      $02,$01             ; FOLLOW WITH ONE CRLF
1113 T BE2C 10                          INC     R0                  ; INCREMENT LOCAL ERROR COUNTER
1114 T BE2D 11                          INC     R1                  ; INCREMENT GOBAL ERROR COUNTER
1115 T BE2E 6896                        SRET    R6                  ; RETURN
1116                           ;******************************************************************************
1117                           ;
1118                           ;       I/O TEST ERROR
1119                           ;
1120                           ;******************************************************************************
1121 T BE30 6886D800           ERRIO:   SCAL    R6,OSTRN1           ; PRINT MESSAGE
1122 T BE34 492F4F204641494C            DB      'I/O FAILURE TO READ DATA '
            55524520544F2052
            4541442044415441
            20
1123 T BE4D 00                          DB      $00
1124                           
1125 T BE4E 88                          GLO     R8                  ; GET LOW BYTE OF EPROM ADDRESS
1126 T BE4F BD                          PHI     RD                  ; PASS FOR PRINT
1127 T BE50 6886D965                    SCAL    R6,TYPE8            ; PRINT HEX DATA
1128 T BE54 0201                        DB      $02,$01             ; FOLLOW WITH ONE CRLF
1129 T BE56 10                          INC     R0                  ; INCREMENT LOCAL ERROR COUNTER
1130 T BE57 11                          INC     R1                  ; INCREMENT GOBAL ERROR COUNTER
1131 T BE58 6896                        SRET    R6                  ; RETURN
1132                           ;******************************************************************************
1133                           ;
1134                           ;       EVENT FLAG TEST ERROR
1135                           ;
1136                           ;******************************************************************************
1137 T BE5A 6886D800           ERREF:   SCAL    R6,OSTRN1           ; PRINT MESSAGE
1138 T BE5E 4556454E5420464C            DB      'EVENT FLAG ERROR ON EF'
            4147204552524F52
            204F4E204546
1139 T BE74 00                          DB      $00
1140                           
1141 T BE75 88                          GLO     R8                  ; GET LOW BYTE OF EPROM ADDRESS
1142 T BE76 BD                          PHI     RD                  ; PASS FOR PRINT
1143 T BE77 6886D965                    SCAL    R6,TYPE8            ; PRINT HEX DATA
1144 T BE7B 0201                        DB      $02,$01             ; FOLLOW WITH ONE CRLF
1145 T BE7D 10                          INC     R0                  ; INCREMENT LOCAL ERROR COUNTER
1146 T BE7E 11                          INC     R1                  ; INCREMENT GOBAL ERROR COUNTER
1147 T BE7F 6896                        SRET    R6                  ; RETURN
1148                           ;******************************************************************************
1149                           ;
1150                           ;       CLOCK-COUNTER TEST ERROR
1151                           ;
1152                           ;******************************************************************************
1153 T BE81 6886D800           ERRCLK:  SCAL    R6,OSTRN1           ; PRINT MESSAGE
1154 T BE85 0D0D0D0D                    DB      $0D,$0D,$0D,$0D
1155 T BE89 434C4F434B2D434F            DB      'CLOCK-COUNTER ERROR'
            554E544552204552
            524F52
1156 T BE9C 0A0A00                      DB      $0A,$0A,$00
1157                           
1158 T BE9F 10                          INC     R0                  ; INCREMENT LOCAL ERROR COUNTER
1159 T BEA0 11                          INC     R1                  ; INCREMENT GOBAL ERROR COUNTER
1160 T BEA1 6896                        SRET    R6                  ; RETURN
1161                           ;******************************************************************************
1162                           
1163 T BF00                             CORG    $0100               ; SET NEXT PAGE
1164                           
1165                           ;******************************************************************************
1166                           ;
1167                           ;       EPROM PROGRAMING ROUTINE
1168                           ;
1169                           ;       TRANSFER EPROM FROM ROM AT EPROM ADDRESS TO ADDRESS 0000
1170                           ;       AND THEN RUN
1171                           ;
1172                           ;******************************************************************************
1173 T BF00 6886DB6F           IEPROM:  SCAL    R6,CLEAR            ; CLEAR SCREEN
1174 T BF04 6886D800                    SCAL    R6,OSTRN1           ; PRINT MESSAGE
1175 T BF08 0A0D                        DB      $0A,$0D
1176 T BF0A 4C4F4144494E4720            DB      'LOADING EPROM SOFTWARE INTO RAM'
            4550524F4D20534F
            4654574152452049
            4E544F2052414D
1177 T BF29 0A0A0D                      DB      $0A,$0A,$0D
1178 T BF2C 504C454153452057            DB      'PLEASE WAIT...'
            4149542E2E2E
1179 T BF3A 0A0A0D00                    DB      $0A,$0A,$0D,$00
1180                           
1181 T BF3E 68C7D000                    RLDI    R7,EPROM            ; STORAGE ADDREES FOR EPROM CODE
1182 T BF42 68C80000                    RLDI    R8,$0000            ; BASE ADDRESS FOR EPROM CODE
1183 T BF46 68C907FF                    RLDI    R9,$07FF            ; NUMBER OF BYTES
1184                           
1185 T BF4A 07                 01$:     LDN     R7                  ; GET BYTE FROM ROM
1186 T BF4B 58                          STR     R8                  ; STORE IN RAM
1187                                            
1188 T BF4C E7                          SEX     R7                  ; MAKE ROM POINTER SP
1189 T BF4D 08                          LDN     R8                  ; GET BYTE FROM RAM
1190 T BF4E F7                          SM                          ; SUBTRCK BYTES
1191 T BF4F E2                          SEX     R2                  ; RESET SP TO R2
1192 T BF50 3258                        BZ      02$                 ; BYTE OK?
1193                           
1194 T BF52 6886BE04                    SCAL    R6,ERRCOM           ; IF NOT EQUAL ERROR
1195 T BF56 3068                        BR      03$                 ; QUIT ON ERROR
1196                           
1197 T BF58 17                 02$:     INC     R7                  ; INCREMENT ROM ADDRESS
1198 T BF59 18                          INC     R8                  ; INCREMENT RAM ADDRESS
1199 T BF5A 6829BF4A                    DBNZ    R9,01$              ; TRANSFER 2K BYTES
1200                           
1201 T BF5E 6886DB6F                    SCAL    R6,CLEAR            ; CLEAR SCREEN
1202                           
1203 T BF62 68C00000                    RLDI    R0,$0000            ; INITIAL R0 
1204 T BF66 E0                          SEX     R0                  ; R0 IS SP
1205 T BF67 D0                          SEP     R0                  ; R0 IS PC
1206                           ;******************************************************************************
1207                           ;
1208                           ;       EPROM PROGRAMMING ABORTED
1209                           ;
1210                           ;******************************************************************************
1211 T BF68 6886D800           03$:     SCAL    R6,OSTRN1           ; PRINT MESSAGE
1212 T BF6C 0A0D                        DB      $0A,$0D
1213 T BF6E 2A2A2A2A20455052            DB      '**** EPROM PROGRAMING  ABORTED ****'
            4F4D2050524F4752
            414D494E47202041
            424F52544544202A
            2A2A2A
1214 T BF91 0A0D                        DB      $0A,$0D
1215 T BF93 2020202020202050            DB      '       PRESS ANY KEY'
            5245535320414E59
            204B4559
1216 T BFA7 0A0D00                      DB      $0A,$0D,$00
1217 T BFAA 6886D904                    SCAL    R6,READD            ; SCAN KEYBOARD
1218 T BFAE C0B00C                      LBR     MENU
1219                           ;******************************************************************************
1220                           
1221 T C000                             CORG    $0100               ; SET NEXT PAGE
1222                           
1223                           ;******************************************************************************
1224                           ;
1225                           ;       RTE1/RTD1 TEST ROUTINE
1226                           ;
1227                           ;******************************************************************************
1228 T C000 6886DB6F           RTERTD:  SCAL    R6,CLEAR                ; CLEAR SCREEN
1229 T C004 6886D800                    SCAL    R6,OSTRN1               ; PRINT MESSAGE
1230 T C008 0A0D                        DB      $0A,$0D
1231 T C00A 525445312F525444            DB      'RTE1/RTD1 TEST'
            312054455354
1232 T C018 0A0D00                      DB      $0A,$0D,$00
1233                           ;******************************************************************************
1234                           ;
1235                           ;       SET-UP FOR PIO PORTS
1236                           ;
1237                           ;       PORT A FOR DATA INPUT
1238                           ;       PORT B LOW NIBBLE ADDRESS INPUT
1239                           ;       PORT B HIGH NIBBLE OUTPUT ECHO
1240                           ;
1241                           ;******************************************************************************
1242 T C01B 68C24800                    RLDI    R2,RAM+$0800            ; USER STACK
1243 T C01F E3                          SEX     R3                      ; SET SP TO PC
1244 T C020 61                          OUT     1                       ; SELECT I/O GROUP 8
1245 T C021 08                          DB      $08                 ; I/O GROUP 8       
1246 T C022 62                          OUT     2
1247 T C023 0F                          DB      $0F                 ; A IS INPUT
1248 T C024 62                          OUT     2
1249 T C025 F7                          DB      $F7                 ; B IS BIT PROG
1250 T C026 62                          OUT     2
1251 T C027 F0                          DB      $F0                 ; LOW IN,HIGH OUT
1252 T C028 E2                          SEX     R2
1253                           
1254 T C029 68C10001                    RLDI    R1,$0001                ; INITIALIZE TO CHANNEL ONE
1255 T C02D 68C00000                    RLDI    R0,$0000                ; INITIALIZE LINE COUNTER
1256                           ;******************************************************************************
1257                           ;
1258                           ;       INPUT PIO DATA
1259                           ;
1260                           ;******************************************************************************
1261 T C031 E3                 PIO:     SEX     R3                      ; SET SP TO PC
1262 T C032 61                          OUT     1                       ; SELECT I/O GROUP 8
1263 T C033 08                          DB      $08
1264 T C034 E2                          SEX     R2                      ; RESET SP TO R2
1265 T C035 3535               WAIT:    B2      WAIT                    ; WAIT FOR DATA VALID
1266                           ;******************************************************************************
1267 T C037 6E                          INP     6                       ; ADDRESS
1268 T C038 60                          IRX     
1269 T C039 6C                          INP     4                       ; DATA
1270 T C03A 22                          DEC     R2
1271 T C03B F0                          LDX     
1272 T C03C FA0F                        ANI     $0F
1273 T C03E 52                          STR     R2
1274 T C03F B7                          PHI     R7
1275                           ;******************************************************************************
1276 T C040 81                          GLO     R1                      ; LOAD CHANNEL NUMBER
1277 T C041 F7                          SM                          ; COMPARE TO INPUT CHANNEL
1278 T C042 3A35                        BNZ     WAIT                    ; IF NOT SAME WAIT FOR NEXT INPUT
1279                           ;******************************************************************************
1280 T C044 60                          IRX                         ; INCREMENT STACK TO DATA
1281 T C045 F0                          LDX                         ; LOAD DATA
1282 T C046 A7                          PLO     R7                      ; STASH IN REGISTER
1283 T C047 22                          DEC     R2                      ; RESET STACK POINTER
1284                           ;******************************************************************************
1285 T C048 11                          INC     R1                      ; INCREMENT TO NEXT CHANNEL
1286 T C049 81                          GLO     R1                      ; LOAD NEXT CHANNEL
1287 T C04A FF0A                        SMI     $0A                     ; $0A PAST CHANNEL 9?
1288 T C04C 3A52                        BNZ     OUT                     ; IF NOT OUTPUT, OTHERWISE-
1289 T C04E 68C10001                    RLDI    R1,$0001                ; RESET CHANNEL TO ONE
1290                           ;******************************************************************************
1291                           ;
1292                           ;       OUTPUT CHANNEL NUMBER AND INPUT BYTE TO SCREEN
1293                           ;
1294                           ;******************************************************************************
1295 T C052 6886D800           OUT:     SCAL    R6,OSTRN1
1296 T C056 0A0D                        DB      $0A,$0D
1297 T C058 434820                      DB      'CH '
1298 T C05B 00                          DB      $00
1299 T C05C 97                          GHI     R7
1300 T C05D BD                          PHI     RD
1301 T C05E 6886D965                    SCAL    R6,TYPE8
1302 T C062 0302                        DB      $03,$02
1303 T C064 87                          GLO     R7
1304 T C065 BD                          PHI     RD
1305 T C066 6886D9B2                    SCAL    R6,WORD
1306 T C06A 0302                        DB      $03,$02
1307 T C06C 87                          GLO     R7
1308 T C06D BD                          PHI     RD
1309 T C06E 6886D965                    SCAL    R6,TYPE8
1310 T C072 0201                        DB      $02,$01
1311                           
1312 T C074 3F89                        BN4     04$                 ; ABORT ON BREAK
1313                           
1314 T C076 10                          INC     R0                  ; INCREMENT LINE COUNTER
1315 T C077 80                          GLO     R0                  ; GET COUNT
1316 T C078 FF09                        SMI     $09                 ; 9 LINES
1317 T C07A CAC031                      LBNZ    PIO                 ; IF LESS NEXT CHANNEL, OTHERWISE-
1318                           
1319 T C07D 6886DB40                    SCAL    R6,MLFCR            ; LINE UP
1320 T C081 12                          DB      $12                 ; 18 TIMES
1321 T C082 68C00000                    RLDI    R0,$0000            ; RESET LINE COUNTER
1322                           
1323 T C086 C0C031                      LBR     PIO
1324                           ;****************************************************************************
1325                           ;
1326                           ;       RTE1/RTD1 TEST ABORTED
1327                           ;
1328                           ;****************************************************************************
1329 T C089 6886DB6F           04$:     SCAL    R6,CLEAR            ; CLEAR SCREEN
1330 T C08D 6886D800                    SCAL    R6,OSTRN1           ; PRINT MESSAGE
1331 T C091 0A0D                        DB      $0A,$0D
1332 T C093 2A2A2A2A20525445            DB      '**** RTE1/RTD1 TEST ABORTED ****'
            312F525444312054
            4553542041424F52
            544544202A2A2A2A
1333 T C0B3 0A0D00                      DB      $0A,$0D,$00
1334                           ;******************************************************************************
1335                           ;
1336                           ;       REPEAT PROCESS
1337                           ;
1338                           ;*****************************************************************************
1339 T C0B6 6886D800           05$:     SCAL    R6,OSTRN1           ; PRINT MESSAGE
1340 T C0BA 0A0D00                      DB      $0A,$0D,$00         ; 1 LINES DOWN
1341 T C0BD 6886B700                    SCAL    R6,REPEAT           ; CALL REPEAT QUESTION ROUTINE
1342 T C0C1 C2C000                      LBZ     RTERTD              ; REPEAT TEST IF D=0
1343 T C0C4 C0B00C                      LBR     MENU                ; RETURN TO MAIN TEST MENU
1344                           ;******************************************************************************
1345                           ;
1346                           ;       END OF TLX TEST SOFTWARE
1347                           ;
1348                           ;******************************************************************************
1349   C0C7                             END     
There were: 0000 Errors

SECTIONS USED:

 Section           Relocation   Alignment  Type     Begins       Ends
 TLXTEST           absolute                         B000         C0C6


SYMBOL TABLE

SYMBOLS DEFINED:

 Symbol            Section/Type        Attribute Value             Length
 ADCAL             absolute                      B500      
 ADCAL1            absolute                      B533      
 ADCAL2            absolute                      B54A      
 ADTST             absolute                      B300      
 ADTST2            absolute                      B3B0      
 AMENU             absolute                      B17A      
 CLEAR             local constant                DB6F      
 CLKTST            absolute                      BBF3      
 CPUEND            absolute                      BD03      
 CPUTST            absolute                      B800      
 CREAD             absolute                      B728      
 CRLF              local constant                DB1B      
 CUROFF            local constant                DC23      
 CURON             local constant                DC18      
 DACAL             absolute                      B600      
 DACAL1            absolute                      B627      
 DATST1            absolute                      B326      
 DEBUG             local constant                D000      
 DELAY1            local constant                D889      
 EFNTST            absolute                      BAD3      
 EPROM             local constant                D000      
 EPTST             absolute                      B8F6      
 ERRCLK            absolute                      BE81      
 ERRCOM            absolute                      BE04      
 ERREF             absolute                      BE5A      
 ERRIO             absolute                      BE30      
 ERRRAM            absolute                      BDDA      
 IEPROM            absolute                      BF00      
 ITEST             local constant                DD0C      
 M8OUT             local constant                DADD      
 M8OUT1            local constant                DAD7      
 M8OUTD            local constant                DADB      
 MASTER            local constant                C800      
 MENU              absolute                      B00C      
 MLFCR             local constant                DB40      
 MOUT              local constant                DA7C      
 MOUT1             local constant                DA76      
 MOUT3             local constant                D9F4      
 MOUT31            local constant                D9EE      
 MOUT3D            local constant                D9F2      
 MOUTD             local constant                DA7A      
 ORGIN             local constant                B000      
 OSTRN1            local constant                D800      
 OSTRNG            local constant                E804      
 OUT               absolute                      C052      
 OUTIT             absolute                      B3D9      
 PIO               absolute                      C031      
 PIOTST            absolute                      B9E0      
 RAM               local constant                4000      
 RAMTST            absolute                      B848      
 RCA1              local constant                D874      
 READ              local constant                D906      
 READ1             local constant                D900      
 READD             local constant                D904      
 READH             local constant                D8BE      
 READH1            local constant                D8B8      
 READHD            local constant                D8BC      
 READHX            local constant                D898      
 REPEAT            absolute                      B700      
 RTERTD            absolute                      C000      
 RVOFF             local constant                DB99      
 RVON              local constant                DB8E      
 STACK             local constant                3000      
 T8OUT             local constant                DABB      
 T8OUT1            local constant                DAB5      
 T8OUTD            local constant                DAB9      
 TAPERAM           local constant                8C00      
 TAPETOP           local constant                8FFF      
 TOUT3             local constant                D9CE      
 TOUT31            local constant                D9C8      
 TOUT3D            local constant                D9CC      
 TOUT6             local constant                DA51      
 TOUT61            local constant                DA4B      
 TOUT6D            local constant                DA4F      
 TYPE3             local constant                D939      
 TYPE31            local constant                D933      
 TYPE3D            local constant                D937      
 TYPE6             local constant                D950      
 TYPE61            local constant                D94A      
 TYPE6D            local constant                D94E      
 TYPE8             local constant                D965      
 TYPE81            local constant                D95F      
 TYPE8D            local constant                D963      
 TYPED             local constant                D82B      
 TYPED1            local constant                D827      
 TYPEH             local constant                D816      
 TYPEH1            local constant                D810      
 TYPEHD            local constant                D814      
 TYPER             local constant                D82D      
 USER              local constant                2000      
 WAIT              absolute                      C035      
 WORD              local constant                D9B2      
 WORD3             local constant                D974      
 WORD31            local constant                D96E      
 WORD3D            local constant                D972      
 WORD6             local constant                D99A      
 WORD61            local constant                D994      
 WORD6D            local constant                D998      
 WORD81            local constant                D9AC      
 WORD8D            local constant                D9B0      


Assembly time: 0 min, 11 sec